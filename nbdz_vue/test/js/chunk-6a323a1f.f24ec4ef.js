(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a323a1f","chunk-0bfe459e","chunk-2d2244c0"],{"506d":function(t,e,a){"use strict";var o=a("eeb8"),r=a.n(o);r.a},"92c2":function(t,e,a){"use strict";a.r(e);var o,r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-main"},[a("div",{staticClass:"content-header"},[a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.addTask()}}},[t._v("添加任务")])],1),a("Table",{ref:"tables",attrs:{height:"700",data:t.listData,columns:t.listColums,stripe:""}}),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.pageTotal,current:t.pageCurrent,"page-size":t.pageSize,"page-size-opts":[100,200,300,400,500],"show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":t.changePage,"on-page-size-change":t.changePageSize}})],1)]),a("Modal",{attrs:{title:"任务详情","mask-closable":!1,width:"90%",scrollable:"","footer-hide":""},on:{"on-ok":t.saveEdit},model:{value:t.modelEdit,callback:function(e){t.modelEdit=e},expression:"modelEdit"}},[a("Edit",{ref:"edit",attrs:{parent:this,"edit-row":t.eidtRow}})],1)],1)},n=[],i=a("bd86"),s=a("e010"),l=a("a864"),c={data:function(){var t=this;return{listColums:[{title:"任务名称",key:"jobName"},{title:"链接",key:"url",render:function(t,e){return t("a",{props:{type:"person"}},e.row.url)}},{title:"任务所在DLL对应的程序集名称",key:"assemblyName"},{title:"任务组",key:"jobGroup"},{title:"任务描述",key:"remark"},{title:"创建时间",key:"createDate",sortable:!0},{title:"开始运行时间",key:"beginTime",sortable:!0},{title:"结束运行时间",key:"endTime"},{title:"触发器类型",key:"triggerType",render:function(t,e){var a=e.row.triggerType,o="";return 0===a?o="simple":1===a&&(o="cron"),t("span",o)}},{title:"操作",key:"action",width:300,align:"center",render:function(e,a){return 1!==a.row.runStatus?e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.runStatus(a)}}},"执行"),e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.editRow(a)}}},"编辑"),e("Button",{props:{type:"error",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.deleteRow(a)}}},"删除")]):0===a.row.jobStatus?e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.editStatus(a)}}},"启动"),e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.editRow(a)}}},"编辑"),e("Button",{props:{type:"error",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.deleteRow(a)}}},"删除")]):1===a.row.jobStatus?e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.editStatus(a)}}},"暂停"),e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.editRow(a)}}},"编辑"),e("Button",{props:{type:"error",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.deleteRow(a)}}},"删除")]):void 0}}],listData:[],pageCurrent:1,pageTotal:1,pageSize:100,modelEdit:!1,eidtRow:{}}},components:{Edit:l["default"]},methods:(o={loadData:function(){var t=this;t.pageCurrent||(t.pageCurrent=1);var e={pageNum:t.pageCurrent,pageSize:t.pageSize,order:{},query:[],navPropertyPaths:[]};Object(s["GetPage"])(e).then((function(e){t.listData=e.data.data,t.pageTotal=e.data.count})).catch((function(t){console.log(t)}))},changePage:function(t){var e=this;e.currentPage=t,this.loadData()},saveEdit:function(){},editRow:function(t){var e=this,a=t.row;e.modelEdit=!0,e.eidtRow=a},addTask:function(){var t=this;t.modelEdit=!0,t.eidtRow={}},editStatus:function(t){var e=this,a=t.row;0===a.jobStatus?Object(s["Resume"])(a.id).then((function(t){200===t.data.code?e.$Message.info(t.data.msg):e.$Message.error(t.data.msg)})).catch((function(t){console.log(t)})):1===a.jobStatus&&Object(s["Stop"])(a.id).then((function(t){200===t.data.code?e.$Message.info(t.data.msg):e.$Message.error(t.data.msg)})).catch((function(t){console.log(t)}))},runStatus:function(t){var e=this,a=t.row;Object(s["Excute"])(a.id).then((function(t){200===t.data.code?e.$Message.info(t.data.msg):e.$Message.error(t.data.msg)})).catch((function(t){console.log(t)}))},deleteRow:function(t){var e=this,a=t.row;Object(s["Delete"])(a.id).then((function(t){200===t.data.code?(e.$Message.info(t.data.msg),_this.loadData()):e.$Message.error(t.data.msg)})).catch((function(t){console.log(t)}))}},Object(i["a"])(o,"changePage",(function(t){var e=this;e.pageCurrent=t,e.loadData()})),Object(i["a"])(o,"changePageSize",(function(t){var e=this;e.pageSize=t,e.loadData()})),o),mounted:function(){this.loadData()}},u=c,d=(a("506d"),a("2877")),p=Object(d["a"])(u,r,n,!1,null,"3406516e",null);e["default"]=p.exports},a864:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Form",{ref:"formTask",attrs:{"label-position":"right",model:t.Row,rules:t.rule,"label-width":200}},[a("Row",[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"任务名称",prop:"jobName"}},[a("Input",{attrs:{clearable:""},model:{value:t.Row.jobName,callback:function(e){t.$set(t.Row,"jobName",e)},expression:"Row.jobName"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"任务组",prop:"jobGroup"}},[a("Input",{attrs:{clearable:""},model:{value:t.Row.jobGroup,callback:function(e){t.$set(t.Row,"jobGroup",e)},expression:"Row.jobGroup"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"Corn表达式",prop:"cron"}},[a("Input",{attrs:{clearable:""},model:{value:t.Row.cron,callback:function(e){t.$set(t.Row,"cron",e)},expression:"Row.cron"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"任务所在DLL对应的程序集名称",prop:"assemblyName"}},[a("Input",{attrs:{clearable:""},model:{value:t.Row.assemblyName,callback:function(e){t.$set(t.Row,"assemblyName",e)},expression:"Row.assemblyName"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"任务所在类",prop:"className"}},[a("Input",{attrs:{clearable:""},model:{value:t.Row.className,callback:function(e){t.$set(t.Row,"className",e)},expression:"Row.className"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"开始运行时间",prop:"beginTime"}},[a("DatePicker",{staticStyle:{width:"300px"},attrs:{type:"datetime",format:"YYYY-MM-DD HH:mm:ss",placeholder:"请选择开始运行时间"},model:{value:t.Row.beginTime,callback:function(e){t.$set(t.Row,"beginTime",e)},expression:"Row.beginTime"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"结束运行时间",prop:"endTime"}},[a("DatePicker",{staticStyle:{width:"300px"},attrs:{type:"datetime",format:"YYYY-MM-DD HH:mm:ss",placeholder:"请选择开始运行时间"},model:{value:t.Row.endTime,callback:function(e){t.$set(t.Row,"endTime",e)},expression:"Row.endTime"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"触发器类型",prop:"triggerType"}},[a("Select",{staticStyle:{width:"200px"},model:{value:t.Row.triggerType,callback:function(e){t.$set(t.Row,"triggerType",e)},expression:"Row.triggerType"}},[a("Option",{attrs:{value:"0"}},[t._v("simple")]),a("Option",{attrs:{value:"1"}},[t._v("cron")])],1)],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"执行间隔时间(s)",prop:"intervalSecond"}},[a("Input",{attrs:{clearable:""},model:{value:t.Row.intervalSecond,callback:function(e){t.$set(t.Row,"intervalSecond",e)},expression:"Row.intervalSecond"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"外部url",prop:"url"}},[a("Input",{attrs:{clearable:""},model:{value:t.Row.url,callback:function(e){t.$set(t.Row,"url",e)},expression:"Row.url"}})],1)],1)],1),a("Row",[a("Col",{attrs:{span:"24"}},[a("div",{staticStyle:{"text-align":"center"}},[a("Button",{on:{click:function(e){t.parent.modelEdit=!1}}},[t._v("取消")]),a("Button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:function(e){return t.save("formTask")}}},[t._v("保存")])],1)])],1)],1)],1)},r=[],n=(a("7f7f"),a("e010")),i={props:{editRow:Object,parent:Object},computed:{},data:function(){return{Row:{},Roles:[],Depts:[],DeptTree:[],DeptTreeItems:[],modelDept:!1,rule:{jobName:[{required:!0,message:"请输入任务名称",trigger:"blur"}],jobGroup:[{required:!0,message:"请输入任务组",trigger:"blur"}],cron:[{required:!0,message:"请输入cron表达式",trigger:"blur"}],assemblyName:[{required:!0,message:"请输入任务所在DLL对应的程序集名称",trigger:"blur"}],className:[{required:!0,message:"请输入任务所在类",trigger:"blur"}]}}},methods:{save:function(){this.Row.id?this.saveEdit():this.saveAdd()},saveAdd:function(){var t=this;this.saveValidate().then((function(e){e&&Object(n["Add"])(t.Row).then((function(e){var a=e.data,o=(a.data,a.code),r=a.msg;200===o?(t.$Message.info("添加成功"),t.parent.modelEdit=!1,t.parent.loadData()):t.$Message.error({content:r,duration:10,closable:!0})})).catch((function(t){console.log(t)}))}))},saveEdit:function(){var t=this;this.saveValidate().then((function(e){e&&Object(n["Edit"])(t.Row).then((function(e){var a=e.data,o=(a.data,a.code),r=a.msg;200===o?(t.$Message.info("编辑成功"),t.parent.modelEdit=!1,t.parent.loadData()):t.$Message.error({content:r,duration:10,closable:!0})})).catch((function(t){}))}))},saveValidate:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"formTask";return this.$refs[e].validate((function(e){return!!e||(t.$Message.warning("请检查表单数据！"),!1)}))}},watch:{editRow:function(t,e){this.Row=Object.assign({},t)}},mounted:function(){}},s=i,l=a("2877"),c=Object(l["a"])(s,o,r,!1,null,null,null);e["default"]=c.exports},e010:function(t,e,a){"use strict";a.r(e),a.d(e,"GetPage",(function(){return r})),a.d(e,"Add",(function(){return n})),a.d(e,"Edit",(function(){return i})),a.d(e,"Excute",(function(){return s})),a.d(e,"Stop",(function(){return l})),a.d(e,"Resume",(function(){return c})),a.d(e,"Delete",(function(){return u}));var o=a("66df"),r=function(t){return o["default"].request({url:"api/Schedule/GetPage",data:t,method:"post"})},n=function(t){return o["default"].request({url:"api/Schedule/Add",data:t,method:"post"})},i=function(t){return o["default"].request({url:"api/Schedule/Edit",data:t,method:"post"})},s=function(t){return o["default"].request({url:"api/Schedule/Excute/"+t,method:"post"})},l=function(t){return o["default"].request({url:"api/Schedule/Stop/"+t,method:"post"})},c=function(t){return o["default"].request({url:"api/Schedule/Resume/"+t,method:"post"})},u=function(t){return o["default"].request({url:"api/Schedule/Delete/"+t,method:"post"})}},eeb8:function(t,e,a){}}]);