(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0fb8eef6","chunk-3762fb50","chunk-7a6bc735","chunk-13bfbf55","chunk-2d22c863","chunk-2d0b39cc","chunk-2d0e5da3","chunk-2d21ee4a","chunk-749e3724"],{"28b2":function(e,t,n){"use strict";n.r(t),n.d(t,"getPage",(function(){return r})),n.d(t,"getList",(function(){return o})),n.d(t,"Get",(function(){return s})),n.d(t,"Add",(function(){return i})),n.d(t,"Edit",(function(){return l})),n.d(t,"Delete",(function(){return u}));var a=n("66df"),r=function(e){return a["default"].request({url:"api/ResResource/GetPage",data:e,method:"post"})},o=function(e){return a["default"].request({url:"api/ResResource/GetList",data:e,method:"post"})},s=function(e){return a["default"].request({url:"api/ResResource/Get",data:e,method:"post"})},i=function(e){return a["default"].request({url:"api/ResResource/Add",data:e,method:"post"})},l=function(e){return a["default"].request({url:"api/ResResource/Edit",data:e,method:"post"})},u=function(e){return a["default"].request({url:"api/ResResource/Delete/"+e,method:"post"})}},3846:function(e,t,n){n("9e1e")&&"g"!=/./g.flags&&n("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:n("0bfb")})},"4e90":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Form",{ref:"formInline",attrs:{"label-position":"right",model:e.Row,rules:e.ruleUser,"label-width":100}},[n("Row",[n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:"用户名",prop:"userName"}},[n("Input",{attrs:{clearable:""},model:{value:e.Row.userName,callback:function(t){e.$set(e.Row,"userName",t)},expression:"Row.userName"}})],1)],1),n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:"密码",prop:"salt"}},[n("Input",{attrs:{type:"password",clearable:""},model:{value:e.Row.salt,callback:function(t){e.$set(e.Row,"salt",t)},expression:"Row.salt"}})],1)],1)],1),n("Row",[n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:"电话"}},[n("Input",{attrs:{clearable:""},model:{value:e.Row.phone,callback:function(t){e.$set(e.Row,"phone",t)},expression:"Row.phone"}})],1)],1),n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:"部门"}},[n("Input",{attrs:{search:"","enter-button":"",readonly:""},on:{"on-search":e.deptSelect},model:{value:e.Row.deptName,callback:function(t){e.$set(e.Row,"deptName",t)},expression:"Row.deptName"}})],1)],1)],1),n("Row",[n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:"姓名"}},[n("Input",{attrs:{clearable:""},model:{value:e.Row.realName,callback:function(t){e.$set(e.Row,"realName",t)},expression:"Row.realName"}})],1)],1),n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:"头像url"}},[n("Input",{attrs:{clearable:""},model:{value:e.Row.headUrl,callback:function(t){e.$set(e.Row,"headUrl",t)},expression:"Row.headUrl"}})],1)],1)],1),n("Row",[n("Col",{attrs:{span:"24"}},[n("FormItem",{attrs:{label:"角色"}},[n("Select",{attrs:{filterable:"",multiple:"",clearable:""},on:{"on-change":e.rolesSelect},model:{value:e.Row.UserRoles,callback:function(t){e.$set(e.Row,"UserRoles",t)},expression:"Row.UserRoles"}},e._l(e.Roles,(function(t){return n("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.roleName))])})),1)],1)],1)],1),n("Row",[n("Col",{attrs:{span:"24"}},[n("FormItem",{attrs:{label:"邮箱地址"}},[n("Input",{attrs:{clearable:""},model:{value:e.Row.email,callback:function(t){e.$set(e.Row,"email",t)},expression:"Row.email"}})],1)],1)],1),n("Row",[n("Col",{attrs:{span:"24"}},[n("FormItem",{attrs:{label:"备注"}},[n("Input",{attrs:{clearable:""},model:{value:e.Row.remark,callback:function(t){e.$set(e.Row,"remark",t)},expression:"Row.remark"}})],1)],1)],1),n("Row",[n("Col",{attrs:{span:"24"}},[n("div",{staticStyle:{"text-align":"center"}},[n("Button",{on:{click:function(t){e.parent.modelEdit=!1}}},[e._v("取消")]),n("Button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:function(t){return e.save("formInline")}}},[e._v("保存")])],1)])],1)],1),n("Modal",{attrs:{title:"选择部门","mask-closable":!1,width:"300",scrollable:"","footer-hide":""},model:{value:e.modelDept,callback:function(t){e.modelDept=t},expression:"modelDept"}},[n("Tree",{attrs:{data:e.DeptTree},on:{"on-select-change":e.deptTreeChange}})],1)],1)},r=[],o=n("bd86"),s=(n("7f7f"),n("d800")),i=n("95f7"),l=n("f432"),u={props:{editRow:Object,parent:Object},computed:{},data:function(){return{Row:{},Roles:[],Depts:[],DeptTree:[],DeptTreeItems:[],modelDept:!1,ruleUser:{userName:[{required:!0,message:"用户名必填",trigger:"blur"}],userPwd:[{required:!0,message:"密码必填",trigger:"blur"},{type:"string",min:6,message:"密码长度≥6",trigger:"blur"}]}}},watch:{editRow:function(e,t){this.handleReset(),this.Row=Object.assign({},e),this.Row.resUserRoles&&this.Row.resUserRoles.length>0&&(this.Row.UserRoles=this.Row.resUserRoles.map((function(e){return e.id})))}},methods:Object(o["a"])({getRoles:function(){var e=this,t={};Object(i["getList"])(t).then((function(t){var n=t.data,a=n.data;e.Roles=a})).catch((function(e){}))},deptSelect:function(){(!this.Depts||this.Depts.length<=0)&&this.getDepts(),this.modelDept=!0},getDepts:function(){var e=this,t={};Object(l["getList"])(t).then((function(t){var n=t.data,a=n.data;e.Depts=a,e.loadDeptTree()})).catch((function(e){}))},loadDeptTree:function(){var e=this.Depts.filter((function(e){return!e.parentCode||""==e.parentCode}));this.loadDeptTreeChild(e)},loadDeptTreeChild:function(e){for(var t=this,n=function(n){var a=e[n];t.loadDeptTreeItem(a);var r=t.Depts.filter((function(e){return e.parentCode==a.deptCode}));r&&r.length>0&&t.loadDeptTreeChild(r)},a=0;a<e.length;a++)n(a)},loadDeptTreeItem:function(e){var t={title:e.deptName,expand:!0,value:e.deptCode,id:e.id};this.DeptTreeItems.push(t),e.parentCode?this.DeptTreeItems.every((function(n){return n.value!=e.parentCode||(n.children||(n.children=[]),n.children.push(t),!1)})):this.DeptTree.push(t)},deptTreeChange:function(e){var t=e[0];this.Row.deptName=t.title,this.Row.deptId=t.id,this.modelDept=!1},rolesSelect:function(){this.Row.resUserRoles=this.Row.UserRoles.map((function(e){var t={roleId:e};return t}))},save:function(){this.parent.isAdd?this.saveAdd():this.saveEdit()},saveValidate:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"formInline";return this.$refs[t].validate((function(t){return!!t||(e.$Message.warning("请检查表单数据！"),!1)}))},handleReset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"formInline";this.$refs[e].resetFields()},saveEdit:function(){var e=this,t=this;t.saveValidate().then((function(n){n&&(delete t.Row.UserRoles,Object(s["Edit"])(t.Row).then((function(t){200===t.data.code?(e.$Message.info("编辑成功"),e.parent.modelEdit=!1,e.parent.loadData()):e.$Message.error({content:t.data.msg,duration:10,closable:!0})})).catch((function(e){})))}))},saveAdd:function(){var e=this,t=this;t.saveValidate().then((function(n){n&&(delete t.Row.UserRoles,Object(s["Add"])(t.Row).then((function(t){200===t.data.code?(e.$Message.info("编辑成功"),e.parent.modelEdit=!1,e.parent.loadData()):e.$Message.error({content:t.data.msg,duration:10,closable:!0})})).catch((function(e){})))}))}},"handleReset",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"formInline";this.$refs[e].resetFields()})),mounted:function(){this.getRoles()}},c=u,d=n("2877"),f=Object(d["a"])(c,a,r,!1,null,"55ba3e1a",null);t["default"]=f.exports},"579a":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Tree",{attrs:{data:e.functionTree,"show-checkbox":"",multiple:""},on:{"on-check-change":e.checkChange}})],1)},r=[],o=(n("6762"),n("2fdb"),n("28b2")),s={props:{parent:{}},data:function(){return{checkedCodes:[],functions:[],functionTree:[]}},methods:{loadData:function(){var e=this,t=this,n={navPropertyPaths:["resPermissions"]};t.functions=[],t.functionTree=[],Object(o["getList"])(n).then((function(n){var a=n.data;200==a.code?(t.functions=a.data,t.loadFunction()):e.$Message.error({content:msg,duration:10,closable:!0})})).catch((function(e){}))},loadFunction:function(){var e=this;e.functionTree=e.functions.map((function(t){var n={expand:!0,checked:!1,children:[]};return n.title=t.cnName,n.id=t.id,t.resPermissions.length>0&&(n.children=t.resPermissions.map((function(t){var n={expand:!0};return n.checked=e.checkedCodes.includes(t.id),n.title=t.cnName,n.id=t.id,n}))),n}))},functionSelect:function(e){var t=e,n=this;n.checkedCodes=[],t.length>0&&(n.checkedCodes=t.map((function(e){return e.id}))),n.loadFunction()},checkChange:function(e){var t=this,n=e;t.checkedCodes=[],t.checkedCodes=n}},mounted:function(){this.loadData()}},i=s,l=n("2877"),u=Object(l["a"])(i,a,r,!1,null,null,null);t["default"]=u.exports},"6b54":function(e,t,n){"use strict";n("3846");var a=n("cb7c"),r=n("0bfb"),o=n("9e1e"),s="toString",i=/./[s],l=function(e){n("2aba")(RegExp.prototype,s,e,!0)};n("79e5")((function(){return"/a/b"!=i.call({source:"a",flags:"b"})}))?l((function(){var e=a(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?r.call(e):void 0)})):i.name!=s&&l((function(){return i.call(this)}))},"707c":function(e,t,n){},"95f7":function(e,t,n){"use strict";n.r(t),n.d(t,"getList",(function(){return r})),n.d(t,"getPage",(function(){return o})),n.d(t,"Add",(function(){return s})),n.d(t,"Edit",(function(){return i})),n.d(t,"Delete",(function(){return l})),n.d(t,"getFunctions",(function(){return u})),n.d(t,"saveFunctions",(function(){return c}));var a=n("66df"),r=function(e){return a["default"].request({url:"api/ResRole/GetList",data:e,method:"post"})},o=function(e){return a["default"].request({url:"api/ResRole/GetPage",data:e,method:"post"})},s=function(e){return a["default"].request({url:"api/ResRole/Add",data:e,method:"post"})},i=function(e){return a["default"].request({url:"api/ResRole/Edit",data:e,method:"post"})},l=function(e){return a["default"].request({url:"api/ResRole/Delete/"+e,method:"post"})},u=function(e){return a["default"].request({url:"api/ResRole/GetPermissions/"+e,method:"post"})},c=function(e,t){return a["default"].request({url:"api/ResRole/SaveFunctions/"+e,data:t,method:"post"})}},b826:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content-main"},[n("div",{staticClass:"search-con search-con-top"},[n("Form",{ref:"formInline",attrs:{"label-position":"right","label-width":60,inline:""}},[n("FormItem",{attrs:{label:"用户名"}},[n("Input",{staticClass:"search-input",attrs:{clearable:""},model:{value:e.filters.userName,callback:function(t){e.$set(e.filters,"userName",t)},expression:"filters.userName"}})],1),n("FormItem",{attrs:{label:"电话"}},[n("Input",{staticClass:"search-input",attrs:{clearable:""},model:{value:e.filters.phone,callback:function(t){e.$set(e.filters,"phone",t)},expression:"filters.phone"}})],1),n("FormItem",[n("Button",{staticClass:"search-btn",attrs:{type:"primary"},on:{click:function(t){return e.loadFilter()}}},[n("Icon",{attrs:{type:"search"}}),e._v("  搜索\n        ")],1)],1)],1)],1),n("Card",[n("div",{staticClass:"button-top-warp"},[n("Button",{staticClass:"search-btn",attrs:{type:"success",size:"small"},on:{click:e.handleAdd}},[n("Icon",{attrs:{type:"md-add"}}),e._v("  新增\n      ")],1)],1),n("Table",{ref:"tables",attrs:{data:e.listData,columns:e.tableColumns1,stripe:""}}),n("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[n("div",{staticStyle:{float:"right"}},[n("Page",{attrs:{total:e.pageTotal,current:e.pageCurrent,"page-size":e.pageSize,"page-size-opts":[100,200,300,400,500],"show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)])],1),n("Modal",{attrs:{title:"编辑","mask-closable":!1,width:"800",scrollable:"","footer-hide":""},model:{value:e.modelEdit,callback:function(t){e.modelEdit=t},expression:"modelEdit"}},[n("Edit",{ref:"edit",attrs:{parent:this,"edit-row":e.eidtRow}})],1),n("Modal",{attrs:{title:"权限","mask-closable":!1,width:"800",scrollable:"","footer-hide":""},model:{value:e.modelPermission,callback:function(t){e.modelPermission=t},expression:"modelPermission"}},[n("Permission",{ref:"Permission",attrs:{parent:this,"edit-row":e.eidtRow}})],1)],1)},r=[],o=(n("707c"),n("d800")),s=n("4e90"),i=n("be93"),l={name:"userManage",components:{Edit:s["default"],Permission:i["default"]},data:function(){var e=this;return{filters:{userName:"",phone:""},listData:[],pageTotal:0,pageCurrent:1,pageSize:100,tableColumns1:[{title:"编号",key:"id"},{title:"用户名",key:"userName"},{title:"真实姓名",key:"realName"},{title:"电话",key:"phone"},{title:"部门",key:"deptName"},{title:"创建时间",key:"createDate"},{title:"操作",key:"action",width:300,align:"center",render:function(t,n){return t("div",[t("Button",{props:{type:"default",size:"small",icon:"md-key"},style:{marginRight:"5px"},on:{click:function(){e.handlePermission(n)}}},"授权"),t("Button",{props:{type:"primary",size:"small",icon:"md-create"},style:{marginRight:"5px"},on:{click:function(){e.handleEdit(n)}}},"编辑"),t("Button",{props:{type:"error",size:"small",icon:"md-trash"},on:{click:function(){e.handleDelete(n)}}},"删除")])}}],modelEdit:!1,eidtRow:{},isAdd:!1,modelPermission:!1}},computed:{},methods:{loadData:function(){var e=this,t=this;t.pageCurrent||(t.pageCurrent=1);var n=[],a={},r={};t.filters.userName&&""!=t.filters.userName&&(a={key:"userName",binaryop:"eq",value:t.filters.userName,andorop:"and"},n.push(a)),t.filters.phone&&""!=t.filters.phone&&(r={key:"phone",binaryop:"eq",value:t.filters.phone,andorop:"and"},n.push(r));var s={pageNum:t.pageCurrent,pageSize:t.pageSize,order:{},query:n,navPropertyPaths:["resUserRoles"]};Object(o["getList"])(s).then((function(n){200==n.data.code?(t.listData=n.data.data,t.pageTotal=n.data.count):e.$Message.error({content:n.data.msg,duration:10,closable:!0})})).catch((function(e){console.log(e)}))},handleDelete:function(e){var t=this;this.$Modal.confirm({title:"提示",content:"<p>确定要删除?</p>",onOk:function(){Object(o["Delete"])(e.row.id).then((function(e){var n=e.data;200==n.code?t.$Message.info("删除成功"):t.$Message.error({content:n.msg,duration:10,closable:!0})})).catch((function(e){console.log(e)}))},onCancel:function(e){}})},handleEdit:function(e){var t=this;t.eidtRow=e.row,t.isAdd=!1,t.modelEdit=!0},handlePermission:function(e){var t=this;t.eidtRow=e.row,t.modelPermission=!0},changePage:function(e){var t=this;t.pageCurrent=e,t.loadData()},changePageSize:function(e){var t=this;t.pageSize=e,t.loadData()},loadFilter:function(){var e=this;e.pageCurrent=1,e.loadData()},handleAdd:function(){var e=this;e.eidtRow={},e.isAdd=!0,e.modelEdit=!0}},mounted:function(){this.loadData()}},u=l,c=n("2877"),d=Object(c["a"])(u,a,r,!1,null,null,null);t["default"]=d.exports},be93:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Form",{ref:"formInline",attrs:{"label-position":"right",model:e.Row,"label-width":100}},[n("Row",[n("Col",{attrs:{span:"24"}},[n("div",{staticStyle:{height:"500px",overflow:"auto"}},[n("function-tree-check",{ref:"functionTreeCheck",attrs:{parent:this}})],1)])],1),n("Row",[n("Col",{attrs:{span:"24"}},[n("div",{staticStyle:{"text-align":"center","padding-top":"10px"}},[n("Button",{on:{click:function(t){e.parent.modelPermission=!1}}},[e._v("取消")]),n("Button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:function(t){return e.save()}}},[e._v("保存")])],1)])],1)],1)],1)},r=[],o=(n("6b54"),n("579a")),s=n("d800"),i={props:{editRow:Object,parent:Object},components:{FunctionTreeCheck:o["default"]},data:function(){return{Row:{}}},methods:{getFunctions:function(){var e=this,t=this;Object(s["getPermissions"])(t.Row.id).then((function(t){var n=t.data,a=n.data,r=n.code,o=n.msg;200===r?e.$refs.functionTreeCheck.functionSelect(a):e.$Message.error({content:o,duration:10,closable:!0})})).catch((function(e){}))},save:function(){this.saveFunctions()},saveFunctions:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var e=this,t=this.$refs.functionTreeCheck.functionTreeItems,n=t.filter((function(e){return 1==e.checked})).map((function(e){return e.value}));saveFunctions(this.Row.userCode,n).then((function(t){var n=t.data,a=(n.data,n.code),r=n.msg;1==a?(e.$Message.info("保存成功"),e.parent.modelPermission=!1,e.parent.loadData()):e.$Message.error({content:r,duration:10,closable:!0})})).catch((function(e){}))}))},watch:{editRow:function(e,t){this.Row=Object.assign({},e),this.Row.id&&this.getFunctions()}},mounted:function(){}},l=i,u=n("2877"),c=Object(u["a"])(l,a,r,!1,null,null,null);t["default"]=c.exports},d800:function(e,t,n){"use strict";n.r(t),n.d(t,"getList",(function(){return r})),n.d(t,"Get",(function(){return o})),n.d(t,"Add",(function(){return s})),n.d(t,"Edit",(function(){return i})),n.d(t,"Delete",(function(){return l})),n.d(t,"getPermissions",(function(){return u}));var a=n("66df"),r=(n("4360"),function(e){return a["default"].request({url:"api/User/GetPage",data:e,method:"post"})}),o=function(e){return a["default"].request({url:"/api/User/Get",data:e,method:"post"})},s=function(e){return a["default"].request({url:"api/User/Add",data:e,method:"post"})},i=function(e){return a["default"].request({url:"api/User/Edit",data:e,method:"post"})},l=function(e){return a["default"].request({url:"api/User/Delete/"+e,method:"post"})},u=function(e){return a["default"].request({url:"api/User/GetUserPermissions?userId="+e,method:"post"})}},f432:function(e,t,n){"use strict";n.r(t),n.d(t,"getList",(function(){return r})),n.d(t,"getChildList",(function(){return o})),n.d(t,"Add",(function(){return s})),n.d(t,"Edit",(function(){return i})),n.d(t,"Delete",(function(){return l})),n.d(t,"Get",(function(){return u}));var a=n("66df"),r=function(e){return a["default"].request({url:"api/ResDept/GetList",data:e,method:"post"})},o=function(e){return a["default"].request({url:"api/ResDept/GetChildList/"+e,method:"post"})},s=function(e){var t=e;return a["default"].request({url:"api/ResDept/Add",data:t,method:"post"})},i=function(e){var t=e;return a["default"].request({url:"api/ResDept/Edit",data:t,method:"post"})},l=function(e){return a["default"].request({url:"api/ResDept/Delete/"+e,method:"post"})},u=function(e){return a["default"].request({url:"api/ResDept/Get",data:e,method:"post"})}}}]);